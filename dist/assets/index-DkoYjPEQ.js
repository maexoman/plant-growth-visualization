(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();class T{#e;#t;#i;#s;constructor(t,i){this.#e=t.int(14,18),this.#t=t.int(25,30),this.#i=i,this.#s=0}get position(){return this.#i}get size(){return this.#s}get petalCount(){return this.#e}isFullyGrown(){return this.#s>=this.#t}grow(){this.isFullyGrown()||(this.#s+=1)}}const v=Math.pow(10,8);function c(e){return Math.trunc(e*v)/v}class h{static zero=new h(0,0);#e;#t;constructor(t,i){this.#e=t,this.#t=i}get x(){return this.#e}get y(){return this.#t}magnitude(){return c(this.#i())}#i(){const t=this.#e*this.#e,i=this.#t*this.#t;return Math.sqrt(t+i)}normalized(){const t=this.#i();if(t===0)return new h(0,0);const i=this.#e/t,s=this.#t/t;return new h(c(i),c(s))}scale(t){const i=this.#e*t,s=this.#t*t;return new h(c(i),c(s))}static add(t,...i){let s=t.#e,r=t.#t;for(const l of i)s+=l.#e,r+=l.#t;return new h(c(s),c(r))}static subtract(t,i){const s=t.#e+i.#e,r=t.#t+i.#t;return new h(c(s),c(r))}static#s(t,i){return t.#e*i.#e+t.#t*i.#t}static angle(t,i){const s=this.#s(t,i),r=t.#i()*i.#i();return r===0?0:Math.acos(s/r)}static clampVectorAngle(t,i,s){const r=t.magnitude(),l=i.magnitude();if(r===0||l===0)return i;const o=t.normalized(),n=i.normalized();let a=o.x*n.x+o.y*n.y;if(a=Math.max(-1,Math.min(1,a)),Math.acos(a)<=s)return i;const y=(o.x*n.y-o.y*n.x>=0?1:-1)*s,m=Math.cos(y),f=Math.sin(y),P=new h(o.x*m-o.y*f,o.x*f+o.y*m);return new h(P.x*l,P.y*l)}static atAngle(t,i){const s=t.normalized(),r=Math.sin(i),l=Math.cos(i),o=s.x*l-s.y*r,n=s.x*r+s.y*l;return new h(o,n).normalized()}}class b{#e;#t;#i;#s;#r;#n;#l;#o;#a=null;constructor(t,i){this.#t=i.segmentMax,this.#i=i.segmentSize,this.#s=C(i.changeAngleMaxDeg),this.#e=t,this.#r=i.sunInfluence,this.#n=i.gravityInfluence,this.#l=i.randomJitterInfluence,this.#o=[]}isFullyGrown(){return this.segments.length>=this.#t}grow(t){if(this.isFullyGrown())return;const i=this.endPosition;let s=this.#h(t);this.#a!==null&&(s=h.clampVectorAngle(this.#a,s,this.#s)),this.#a=s;const r=s.scale(this.#i),l=h.add(i,r);this.#o.push({startPosition:i,endPosition:l})}get endPosition(){return this.#o.length>0?this.#o[this.#o.length-1].endPosition:this.#e}get normalizedLength(){return this.#o.length/this.#t}calculateAuxillaryBud(t){if(this.#a===null)return null;const i=h.atAngle(this.#a,C(t));return{startPosition:this.endPosition,growDirection:i}}#h(t){return h.add(this.#u(t),this.#d(t),this.#f(t)).normalized()}#d(t){const i=t.calculateNormalizedSunRayTo(this.endPosition);return new h(i.x*this.#r.xInfluence,i.y*this.#r.yInfluence)}#u(t){return new h(t.gravity.x*this.#n.xInfluence,t.gravity.y*this.#n.yInfluence)}#f(t){if(this.#l.xInfluence===0&&this.#l.yInfluence===0)return h.zero;const i=t.random.int(1,100),s=t.random.int(0,100)>=50?-1:1,r=t.random.int(1,100),l=t.random.int(0,100)>=50?-1:1,o=new h(s*i,l*r).normalized();return new h(o.x*this.#l.xInfluence,o.y*this.#l.yInfluence)}get segments(){return this.#o}}function C(e){return e*Math.PI/180}class z{#e;#t;#i;#s;#r;#n;#l;constructor(t,i,s){this.#e=t.startPosition,this.#t=t.growDirection,this.#i=i,this.#s=0,this.#r=t.startPosition,this.#n=s,this.#l=0}isFullyGrown(){return this.#s>=this.#i&&this.#l>=this.#n}grow(){if(this.#s<this.#i){this.#a();return}if(this.#l<this.#n){this.#o();return}}#o(){this.#l+=2}#a(){this.#s+=1,this.#r=h.add(this.#e,this.#t.scale(this.#s))}get stemSegment(){return{startPosition:this.#e,endPosition:this.#r}}get area(){return this.#l}}class B{#e;#t;#i;#s;#r=[];#n=null;constructor(t){this.#e=t,this.#t="growing",this.#i=new b(new h(t.middleX,t.groundY),{segmentMax:250,segmentSize:2,changeAngleMaxDeg:2,sunInfluence:{xInfluence:-3,yInfluence:-3},gravityInfluence:{xInfluence:0,yInfluence:-1},randomJitterInfluence:{xInfluence:0,yInfluence:0}}),this.#s=Array(5).fill(1).map(()=>new b(new h(t.middleX,t.groundY),{segmentMax:150,segmentSize:1,changeAngleMaxDeg:10,sunInfluence:{xInfluence:5,yInfluence:5},gravityInfluence:{xInfluence:0,yInfluence:1},randomJitterInfluence:{xInfluence:5,yInfluence:5}}))}#l=0;#o=0;update(t){if(this.#o+=t,this.#l+=t,this.#t==="growing"){if(this.#i.grow(this.#e),this.#s.forEach(i=>i.grow(this.#e)),this.#r.forEach(i=>i.grow()),this.#o=0,this.#e.random.int(1,100)<Math.round(.05*Math.round((.75-this.#i.normalizedLength)*100))){const i=this.#r.length%2==0?1:-1,s=this.#i.calculateAuxillaryBud(i*this.#e.random.int(20,60));if(s===null)return;this.#r.push(new z(s,this.#e.random.int(50,100),this.#e.random.int(30,50)))}this.#i.isFullyGrown()&&this.#r.every(i=>i.isFullyGrown())&&(this.#t="flowering")}this.#t==="flowering"&&(this.#n===null&&(this.#n=new T(this.#e.random,this.#i.endPosition)),this.#n.grow()),this.#l>=3e4&&(this.#t="dead")}get state(){return this.#t}reset(){}get flower(){return this.#n}get leafs(){return this.#r}get topPosition(){return this.#i.endPosition}get stemGSegments(){return this.#i.segments}get rootGSegments(){return this.#s.map(t=>t.segments)}}class O{#e;#t;#i;constructor(t){typeof t=="number"&&Number.isFinite(t)?this.#e=t:this.#e=G(0,16777215),this.#t=this.#e,this.#i=()=>{let i=this.#t+=1831565813;return i=Math.imul(i^i>>>15,i|1),i^=i+Math.imul(i^i>>>7,i|61),((i^i>>>14)>>>0)/4294967296}}get seed(){return this.#e}int(t,i){const s=Math.ceil(t),r=Math.floor(i);return Math.floor(this.#i()*(r-s+1)+s)}number(t,i){return Math.floor(this.#i()*(i-t+1)+t)}}function G(e,t){const i=Math.ceil(e),s=Math.floor(t);return Math.floor(Math.random()*(s-i+1)+i)}const L=3/4,E=0/8,F=3/4;class R{random;#e;#t;middleX;groundY;sunY;#i;#s;#r;#n=[];constructor(t,i,s){this.random=t,this.#e=i,this.#t=s,this.middleX=Math.round(this.#e/2),this.sunY=Math.round(this.#t*(1-E)),this.groundY=Math.round(this.#t*(1-L)),this.#s=new h(0,0),this.#i=new h(this.middleX,this.sunY),this.#r=new B(this)}moveSun(t){if(!(-100<=t&&t<=100)){console.warn(`offset not in range [-100, 100]. offset: ${t}`);return}const s=t/100,r=F*this.#e,l=s*(1/2)*r;this.#i=new h(this.middleX+l,this.sunY)}setGravity(t){if(!(0<=t&&t<=10)){console.warn(`offset not in range [0, 10]. offset: ${t}`);return}this.#s=new h(0,-t)}update(t){this.#r.update(t)}reset(){this.#r.reset()}isExposedToSun(t){return t.y>=this.groundY}calculateNormalizedSunRayTo(t){if(!this.isExposedToSun(t))return h.zero;const i=t.x-this.#i.x,s=t.y-this.#i.y;return new h(i,s).normalized()}get sunPosition(){return this.#i}get gravity(){return this.#s}get sunRay(){return this.calculateNormalizedSunRayTo(new h(this.middleX,this.groundY))}get plant(){return this.#r}get flower(){return this.#r.flower}get leafs(){return this.#r.leafs}get stemSegments(){return this.#n}get stemGSegments(){return this.#r.stemGSegments}get rootGSegments(){return this.#r.rootGSegments}}const S=new h(0,-10);function N(){const e=document.getElementById("canvas"),t=e.getContext("2d"),i=document.getElementById("ghost-canvas"),s=i.getContext("2d"),r=new O,l=new R(r,e.width,e.height);let o=!1;window.gr=.75;let n=!1,a;function d(f){a===void 0&&(a=f);const P=f-a;try{o===!0&&l.update(P),A(t,l),l.plant.state==="dead"&&n===!1&&(J(s,l,l.plant),i.style.display="block",n=!0)}catch(w){o=!1,console.error(w)}requestAnimationFrame(d),a=f}requestAnimationFrame(d),document.getElementById("btn-start").addEventListener("click",function(){o=!0}),document.getElementById("btn-reset").addEventListener("click",function(){o=!1,l.reset(),alert(r.seed)});const y=document.getElementById("sld-sun");y.addEventListener("input",function(){let f=0;try{if(f=parseInt(y.value,10),Number.isNaN(f))return}catch{return}l.moveSun(f)});const m=document.getElementById("sld-gravity");m.addEventListener("input",function(){let f=0;try{if(f=parseInt(m.value,10),Number.isNaN(f))return}catch{return}window.gr=f,l.setGravity(f)})}function A(e,t){let i=e.fillStyle,s=e.lineWidth,r=e.strokeStyle;const{width:l,height:o}=e.canvas;e.clearRect(0,0,l,o),i=e.fillStyle,e.fillStyle="lightblue",e.fillRect(0,0,l,o-t.groundY),e.fillStyle=i,i=e.fillStyle,e.fillStyle="#987654",e.fillRect(0,o-t.groundY,l,o),e.fillStyle=i,s=e.lineWidth,r=e.strokeStyle,e.lineWidth=4,e.strokeStyle="#4c3228",e.beginPath(),e.moveTo(0,o-t.groundY),e.lineTo(l,o-t.groundY),e.stroke(),e.closePath(),e.lineWidth=s,e.strokeStyle=r,s=e.lineWidth,r=e.strokeStyle,e.lineWidth=8,e.strokeStyle="#ffde21";const n=t.sunRay.scale(200),a=new h(n.y,-n.x).normalized().scale(55),d=a.scale(-1),u=h.add(t.sunPosition,n);e.beginPath(),e.moveTo(t.sunPosition.x,o-t.sunPosition.y),e.lineTo(u.x,o-u.y);const g=h.add(t.sunPosition,a),y=h.add(u,a);e.moveTo(g.x,o-g.y),e.lineTo(y.x,o-y.y);const m=h.add(t.sunPosition,d),f=h.add(u,d);e.moveTo(m.x,o-m.y),e.lineTo(f.x,o-f.y),e.stroke(),e.closePath(),e.lineWidth=s,e.strokeStyle=r,i=e.fillStyle,e.fillStyle="lightblue",e.beginPath(),e.arc(t.sunPosition.x,o-t.sunPosition.y,125,0,2*Math.PI),e.fill(),e.closePath(),e.fillStyle=i,i=e.fillStyle,e.fillStyle="#ffde21",e.beginPath(),e.arc(t.sunPosition.x,o-t.sunPosition.y,100,0,2*Math.PI),e.fill(),e.closePath(),e.fillStyle=i,i=e.fillStyle,e.fillStyle="#654321",Y(e,t.middleX,o-(t.groundY-15),15,20),e.fillStyle=i,X(e,t,t.plant)}function Y(e,t,i,s,r){D(e,t-s/2,i-r/2,s,r)}function D(e,t,i,s,r){var l=.5522848,o=s/2*l,n=r/2*l,a=t+s,d=i+r,u=t+s/2,g=i+r/2;e.fillStyle="#654321",e.beginPath(),e.moveTo(t,g),e.bezierCurveTo(t,g-n,u-o,i,u,i),e.bezierCurveTo(u+o,i,a,g-n,a,g),e.bezierCurveTo(a,g+n,u+o,d,u,d),e.bezierCurveTo(u-o,d,t,g+n,t,g),e.fill()}function X(e,t,i){p(e,i,{positionOffset:S,thickness:6,color:"#d1bc8a",borderWidth:2,borderColor:"#000000"}),k(e,i,{positionOffset:S,thickness:8,color:"#008000",borderWidth:2,borderColor:"#000000"}),W(e,t,i.leafs,{positionOffset:S,color:"#008000",borderWidth:2,borderColor:"#000000"}),M(e,i.flower,{positionOffset:S,carpelSizeFraction:2/3,carpelBorderWidth:2,carpelColor:"#654321",carpelBorderColor:"#000000",petalWidth:10,petalBorderWidth:2,oddPetalColor:"#FFDA03",oddPetalBorderColor:"#000000",evenPetalColor:"#EDC001",evenPetalBorderColor:"#000000"})}function J(e,t,i){const s="#ffffff";p(e,i,{positionOffset:S,thickness:8,color:s,borderWidth:0,borderColor:"#00000000"}),k(e,i,{positionOffset:S,thickness:10,color:s,borderWidth:0,borderColor:"#00000000"}),W(e,t,i.leafs,{positionOffset:S,color:s,borderWidth:2,borderColor:s}),M(e,i.flower,{positionOffset:S,carpelSizeFraction:2/3,carpelBorderWidth:0,carpelColor:s,carpelBorderColor:"#00000000",petalWidth:12,petalBorderWidth:0,oddPetalColor:s,oddPetalBorderColor:"#00000000",evenPetalColor:s,evenPetalBorderColor:"#00000000"})}function W(e,t,i,s){for(const r of i){if(r.area<=0)continue;const l=r.stemSegment.endPosition,o=l.x<=t.middleX,n=h.add(l,s.positionOffset);o?q(e,n,r.area,{color:s.color,borderColor:s.borderColor,borderWidth:s.borderWidth}):K(e,n,r.area,{color:s.color,borderColor:s.borderColor,borderWidth:s.borderWidth})}}function k(e,t,i){i.borderWidth>0&&I(e,t,{positionOffset:i.positionOffset,thickness:i.thickness+i.borderWidth,color:i.borderColor}),I(e,t,{positionOffset:i.positionOffset,thickness:i.thickness,color:i.color})}function I(e,t,i){if(t.stemGSegments.length===0&&t.leafs.length===0)return;const s=e.fillStyle,r=e.lineWidth,l=e.strokeStyle,o=e.lineCap;if(e.lineWidth=i.thickness,e.strokeStyle=i.color,e.lineCap="round",t.stemGSegments.length>0){const n=h.add(t.stemGSegments[0].startPosition,i.positionOffset);e.beginPath(),e.moveTo(n.x,e.canvas.height-n.y);for(let a=1;a<t.stemGSegments.length;a+=1){const d=h.add(t.stemGSegments[a].endPosition,i.positionOffset);e.lineTo(d.x,e.canvas.height-d.y)}e.stroke()}for(const n of t.leafs){const a=h.add(n.stemSegment.startPosition,i.positionOffset),d=h.add(n.stemSegment.endPosition,i.positionOffset);e.beginPath(),e.moveTo(a.x,e.canvas.height-a.y),e.lineTo(d.x,e.canvas.height-d.y),e.stroke()}e.lineWidth=r,e.lineCap=o,e.strokeStyle=l,e.fillStyle=s}function p(e,t,i){if(t.rootGSegments.length===0)return;const s=e.fillStyle,r=e.lineWidth,l=e.strokeStyle,o=e.lineCap;e.lineCap="round";for(const n of t.rootGSegments){if(n.length===0)continue;const a=h.add(n[0].startPosition,i.positionOffset);if(i.borderWidth){e.lineWidth=i.thickness+i.borderWidth,e.strokeStyle=i.borderColor,e.beginPath(),e.moveTo(a.x,e.canvas.height-a.y);for(let d=1;d<n.length;d+=1){const u=h.add(n[d].endPosition,i.positionOffset);e.lineTo(u.x,e.canvas.height-u.y)}e.stroke()}e.lineWidth=i.thickness,e.strokeStyle=i.color,e.beginPath(),e.moveTo(a.x,e.canvas.height-a.y);for(let d=1;d<n.length;d+=1){const u=h.add(n[d].endPosition,i.positionOffset);e.lineTo(u.x,e.canvas.height-u.y)}e.stroke()}e.lineWidth=r,e.lineCap=o,e.strokeStyle=l,e.fillStyle=s}function M(e,t,i){if(t===null)return;const s=e.fillStyle,r=e.lineWidth,l=e.strokeStyle,o=e.lineCap,n=h.add(t.position,i.positionOffset);e.lineCap="round";for(let a=0;a<t.petalCount;a+=1){const d=a*360/t.petalCount,u=h.atAngle(new h(0,-1),d*Math.PI/180),g=h.add(n,u.scale(t.size));i.petalBorderWidth>0&&(e.lineWidth=i.petalWidth+i.petalBorderWidth,e.strokeStyle=a%2==0?i.evenPetalBorderColor:i.oddPetalBorderColor,e.beginPath(),e.moveTo(n.x,e.canvas.height-n.y),e.lineTo(g.x,e.canvas.height-g.y),e.stroke()),e.lineWidth=i.petalWidth,e.strokeStyle=a%2==0?i.evenPetalColor:i.oddPetalColor,e.beginPath(),e.moveTo(n.x,e.canvas.height-n.y),e.lineTo(g.x,e.canvas.height-g.y),e.stroke()}e.lineWidth=i.carpelBorderWidth,e.strokeStyle=i.carpelBorderColor,e.fillStyle=i.carpelColor,e.beginPath(),e.arc(n.x,e.canvas.height-n.y,t.size*i.carpelSizeFraction,0,2*Math.PI),e.fill(),i.carpelBorderWidth>0&&e.stroke(),e.lineWidth=r,e.lineCap=o,e.strokeStyle=l,e.fillStyle=s}function q(e,t,i,s){const r=e.fillStyle,l=e.lineWidth,o=e.strokeStyle,n=1/28*i,a=1/30*i,d=t.x-(15*n-n),u=e.canvas.height-t.y-(9*a-a);e.lineWidth=s.borderWidth,e.strokeStyle=s.borderColor,e.fillStyle=s.color,e.beginPath(),e.lineTo(17*n+d,a+u),e.lineTo(6*n+d,2*a+u),e.lineTo(3*n+d,10*a+u),e.lineTo(n+d,30*a+u),e.lineTo(17*n+d,19*a+u),e.lineTo(26*n+d,13*a+u),e.lineTo(28*n+d,7*a+u),e.lineTo(15*n+d,9*a+u),e.closePath(),e.stroke(),e.fill(),e.lineWidth=l,e.strokeStyle=o,e.fillStyle=r}function K(e,t,i,s){const r=e.fillStyle,l=e.lineWidth,o=e.strokeStyle,n=1/30*i,a=1/48*i,d=t.x-(16*n-n),u=e.canvas.height-t.y-(20*a-a);e.lineWidth=s.borderWidth,e.strokeStyle=s.borderColor,e.fillStyle=s.color,e.beginPath(),e.lineTo(n+d,10*a+u),e.lineTo(16*n+d,20*a+u),e.lineTo(19*n+d,a+u),e.lineTo(30*n+d,15*a+u),e.lineTo(28*n+d,48*a+u),e.lineTo(4*n+d,29*a+u),e.closePath(),e.stroke(),e.fill(),e.lineWidth=l,e.strokeStyle=o,e.fillStyle=r}N();
